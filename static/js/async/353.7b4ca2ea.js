"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["353"],{8562:function(e,s,n){n.r(s),n.d(s,{default:function(){return c}});var r=n(1549),i=n(6603),d=n(7997);function t(e){let s=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",h3:"h3",ul:"ul",li:"li",strong:"strong",div:"div"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.h1,{id:"基础配置",children:["基础配置",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#基础配置",children:"#"})]}),"\n",(0,r.jsx)(s.p,{children:"Gez 作为基础设施，它的配置总是非常简单的。"}),"\n",(0,r.jsxs)(s.h2,{id:"使用",children:["使用",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#使用",children:"#"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\n\nexport default {\n    // 配置选项\n} satisfies GezOptions;\n\n"})}),"\n",(0,r.jsxs)(s.h2,{id:"选项",children:["选项",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#选项",children:"#"})]}),"\n",(0,r.jsxs)(s.h3,{id:"name",children:["name ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#name",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"string"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："}),(0,r.jsx)(s.code,{children:"gez"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 服务的名称，全局唯一。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import type { GezOptions } from '@gez/core';\nimport { name } from '../package.json';\n\nexport default {\n    name,\n} satisfies GezOptions;\n\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["如果你的网站，同一个域名下，使用 Gez 打包了多个项目，那么你需要配置一个 ",(0,r.jsx)(s.code,{children:"name"})," 来区分不同的项目。\n"]})})]}),"\n",(0,r.jsxs)(s.h3,{id:"root",children:["root ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#root",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"string"})]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"默认值："}),(0,r.jsx)(s.code,{children:"cwd()"})]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 项目根目录，默认为当前执行命令的目录。"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsxs)(s.div,{className:"rspress-directive-content",children:[(0,r.jsx)(s.p,{children:"如果你没有充足的理由，你都不应该配置它。"}),"\n"]})]}),"\n",(0,r.jsxs)(s.h3,{id:"isprod",children:["isProd ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#isprod",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"boolean"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"process.env.NODE_ENV === 'production'"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 是否是生产环境。"]}),"\n"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"如果你没有充足的理由，你都不应该配置它。"})})]}),"\n",(0,r.jsxs)(s.h3,{id:"isinstall",children:["isInstall ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#isinstall",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"boolean"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"process.env.npm_config_production !== 'true'"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 安装生产依赖时，是否安装远程依赖。"]}),"\n"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"如果你没有充足的理由，你都不应该配置它。"})})]}),"\n",(0,r.jsxs)(s.h3,{id:"basepathplaceholder",children:["basePathPlaceholder ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#basepathplaceholder",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"string | false"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"[[[___GEZ_DYNAMIC_BASE___]]]"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 动态路径的变量占位符，深入了解请看",(0,r.jsx)(s.a,{href:"/guide/essentials/base-path",children:"基本路径"}),"说明。"]}),"\n"]}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"如果你的业务上，没有出现用户的内容被误替换，你都不应该配置它。"})})]}),"\n",(0,r.jsxs)(s.h2,{id:"模块链接",children:["模块链接",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#模块链接",children:"#"})]}),"\n",(0,r.jsxs)(s.p,{children:["这是 Gez 的核心功能，",(0,r.jsx)(s.a,{href:"/guide/essentials/module-link",children:"点击这里深入了解"}),"。"]}),"\n",(0,r.jsxs)(s.h3,{id:"modulesexports",children:["modules.exports ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#modulesexports",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"string[]"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"[]"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 对外模块导出。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"export default {\n    modules: {\n        exports: [\n            'root:src/components/layout.vue',\n            'root:src/utils/index.ts',\n            'npm:vue',\n            'npm:vue-router'\n        ]\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"你可以将当前项目的模块或者当前项目的第三方依赖，对外导出，这样其它服务就可以使用了。"})})]}),"\n",(0,r.jsxs)(s.h3,{id:"modulesimports",children:["modules.imports ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#modulesimports",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"Record<string, string | [string, string]>"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"{}"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 配置远程依赖。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"export default {\n    modules: {\n        imports: {\n            'ssr-base': ['root:../ssr-base/dist', 'https://<hostname>/ssr-base/versions/latest.json']\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsxs)(s.div,{className:"rspress-directive-content",children:["\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"第一个参数为本地的存储路径"}),"\n",(0,r.jsx)(s.li,{children:"第二个参数是远程依赖的地址"}),"\n",(0,r.jsxs)(s.li,{children:["执行 ",(0,r.jsx)(s.code,{children:"gez install"})," 命令可以下载远程依赖到本地的地址。"]}),"\n"]}),"\n"]})]}),"\n",(0,r.jsx)(s.p,{children:"你也可以直接配置本地地址。"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"export default {\n    modules: {\n        imports: {\n            'ssr-base': 'root:../ssr-base/dist'\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.h3,{id:"modulesexternals",children:["modules.externals ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#modulesexternals",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"Record<string, string>"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"{}"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 外部依赖设置，你可以将当前服务的依赖，指向到其它导出的服务。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"export default {\n    name: 'ssr-main',\n    modules: {\n        externals: {\n            vue: 'ssr-base/npm/vue',\n            'vue-router': 'ssr-base/npm/vue-router'\n        }\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive warning",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"WARNING"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["需要先配置对应服务的 ",(0,r.jsx)(s.a,{href:"#modulesimports",children:"modules.imports"}),"，否则运行起来会报错，提示找不到模块。\n"]})})]}),"\n",(0,r.jsxs)(s.h2,{id:"钩子",children:["钩子",(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#钩子",children:"#"})]}),"\n",(0,r.jsxs)(s.h3,{id:"createdevapp",children:["createDevApp() ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#createdevapp",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"(gez: Gez) => Promise<App>"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"isProd = false"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 创建开发应用，在执行 ",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-dev",children:"dev"}),"、",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-build",children:"build"}),"、",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-preview",children:"preview"})," 命令时调用。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"\nexport default {\n    async createDevApp(gez) {\n        return import('@gez/rspack').then((m) =>\n            m.createRspackHtmlApp(gez, {\n                config(context) {\n                    // 可以在这里修改 Rspack 编译的配置\n                }\n            })\n        );\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsxs)(s.div,{className:"rspress-directive-content",children:["\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Rspack 配置请看",(0,r.jsx)(s.a,{href:"/guide/essentials/rspack",children:"这里"})]}),"\n"]}),"\n"]})]}),"\n",(0,r.jsxs)(s.h3,{id:"createserver",children:["createServer() ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#createserver",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"(gez: Gez) => Promise<void>"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"undefined"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," 创建服务器，执行  ",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-dev",children:"dev"}),"、",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-build",children:"build"}),"、",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-preview",children:"preview"})," 命令时调用。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import http from 'node:http';\n\nexport default {\n    async createServer(gez) {\n        const server = http.createServer((req, res) => {\n            // 静态文件处理\n            gez.middleware(req, res, async () => {\n                // 传入渲染的参数\n                const render = await gez.render({\n                    params: {\n                        url: req.url\n                    }\n                });\n                // 响应 HTML 内容\n                res.end(render.html);\n            });\n        });\n        // 监听端口\n        server.listen(3000, () => {\n            console.log('http://localhost:3000');\n        });\n    },\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsxs)(s.p,{children:["你也可以使用其它的框架来创建服务器，例如：",(0,r.jsx)(s.a,{href:"https://expressjs.com/",target:"_blank",rel:"noopener noreferrer",children:"Express"}),"。\n"]})})]}),"\n",(0,r.jsxs)(s.h3,{id:"postcompileprodhook",children:["postCompileProdHook() ",(0,r.jsx)(d.Badge,{text:"v3.0.0",type:"tip"}),(0,r.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#postcompileprodhook",children:"#"})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"类型："}),(0,r.jsx)(s.code,{children:"(gez: Gez) => Promise<void>"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"默认值："})," ",(0,r.jsx)(s.code,{children:"undefined"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"描述："})," ",(0,r.jsx)(s.a,{href:"/guide/essentials/command#gez-build",children:"gez build"})," 构建完成后，以生产模式执行的钩子。"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",meta:'title="src/entry.node.ts"',children:"import path from 'node:path';\n\nexport default {\n    async postCompileProdHook(gez) {\n        const render = await gez.render({\n            base: '/gez',\n            params: { url: '/' }\n        });\n        gez.writeSync(\n            gez.resolvePath('dist/client', url.substring(1), 'index.html'),\n            rc.html\n        );\n    }\n} satisfies GezOptions;\n"})}),"\n",(0,r.jsxs)(s.div,{className:"rspress-directive tip",children:[(0,r.jsx)(s.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsx)(s.div,{className:"rspress-directive-content",children:(0,r.jsx)(s.p,{children:"你可以使用这个钩子来生成静态网站。"})})]})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}let c=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["guide%2Fessentials%2Fconfig.mdx"]={toc:[{text:"使用",id:"使用",depth:2},{text:"选项",id:"选项",depth:2},{text:"name",id:"name",depth:3},{text:"root",id:"root",depth:3},{text:"isProd",id:"isprod",depth:3},{text:"isInstall",id:"isinstall",depth:3},{text:"basePathPlaceholder",id:"basepathplaceholder",depth:3},{text:"模块链接",id:"模块链接",depth:2},{text:"modules.exports",id:"modulesexports",depth:3},{text:"modules.imports",id:"modulesimports",depth:3},{text:"modules.externals",id:"modulesexternals",depth:3},{text:"钩子",id:"钩子",depth:2},{text:"createDevApp()",id:"createdevapp",depth:3},{text:"createServer()",id:"createserver",depth:3},{text:"postCompileProdHook()",id:"postcompileprodhook",depth:3}],title:"基础配置",frontmatter:{}}}}]);